<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Restaurant Management</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>🍽️ Restaurant Dashboard</h1>
    <button id="theme-toggle" aria-label="Toggle Dark Mode">🌙</button>
  </header>

  <main class="grid">
    <section class="card" id="orders">
      <h2>🧾 Orders</h2>
      <ul id="orders-list">
        <li>Loading...</li>
      </ul>
    </section>

    <section class="card" id="kitchen">
      <h2>👨‍🍳 Kitchen</h2>
      <ul id="kitchen-list">
        <li>Loading...</li>
      </ul>
    </section>

    <section class="card" id="payments">
      <h2>💳 Payments</h2>
      <ul id="payments-list">
        <li>Loading...</li>
      </ul>
    </section>
  </main>

  <footer>
    <p>&copy; 2025 Restaurant Management System</p>
  </footer>

  <script>
    async function fetchData(endpoint, listId, formatter) {
      try {
        const response = await fetch(endpoint);
        const data = await response.json();
        const list = document.getElementById(listId);
        list.innerHTML = ""; // Clear previous content

        data.forEach(item => {
          const li = document.createElement("li");
          li.textContent = formatter(item);
          list.appendChild(li);
        });

      } catch (error) {
        console.error("Error getting data", error);
        document.getElementById(listId).innerHTML = "<li>Error loading data</li>";
      }
    }

    function loadAll() {
      fetchData("http://localhost:5000/orders", "orders-list", item =>
        `Order #${item.id} - Table ${item.table} - ${item.items.join(", ")}`
      );

      fetchData("http://localhost:5000/kitchen", "kitchen-list", item =>
        `Order #${item.id} - ${item.status}`
      );

      fetchData("http://localhost:5000/payments", "payments-list", item =>
        `Order #${item.id} - ${item.paid === 1 ? "Paid ✅" : "Pending 💰"}`
      );

      
    }

    // Load initial data
    loadAll();

    // Regularly refresh data every 10 seconds
    setInterval(loadAll, 10000);

    // Dark Mode Toggle
    const themeToggle = document.getElementById("theme-toggle");
    const body = document.body;

    themeToggle.addEventListener("click", () => {
      body.classList.toggle("dark-mode");
      const isDarkMode = body.classList.contains("dark-mode");
      themeToggle.textContent = isDarkMode ? "☀️" : "🌙";
    });
  </script>
</body>
</html>
